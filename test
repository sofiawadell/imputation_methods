import numpy as np
import pandas as pd

from data_loader import data_loader_ohe_wo_target
from data_loader import data_loader_factor_wo_target_ctgan50
from data_loader import data_loader_ohe_wo_target_ctgan50

from factor_encode_to_ohe import factor_encode_to_ohe

from utils import normalize_numeric
from utils import renormalize_numeric
from utils import rmse_num_loss
from utils import rmse_cat_loss
from utils import m_rmse_loss
from utils import pfc

import time
from sklearn.impute import KNNImputer

data_name = "bank"
miss_rate = 0.1

train_factor_data_x, train_factor_miss_data_x, test_factor_data_x, test_factor_miss_data_x = data_loader_factor_wo_target_ctgan50(data_name, miss_rate) 
train_data_ohe_x, train_ohe_miss_data_x, test_data_ohe_x, test_ohe_miss_data_x = data_loader_ohe_wo_target_ctgan50(data_name, miss_rate) 

# Define mask matrix using OHE data
mask_train = 1-np.isnan(train_ohe_miss_data_x)
mask_test = 1-np.isnan(test_ohe_miss_data_x) 